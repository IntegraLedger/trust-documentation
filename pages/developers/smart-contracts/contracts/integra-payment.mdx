import { Tabs } from 'nextra/components'
import AbiViewer from '../../../../components/AbiViewer'

# IntegraPayment V4.5

Payment processing and fee management for Integra platform operations.

## Overview

IntegraPayment V4.5 handles all payment-related functionality including:
- Payment processing for platform services
- Fee distribution and management
- Multi-token support (ETH, ERC-20)
- Escrow functionality for secure transactions
- Payment verification and receipts

## Contract Interface

<AbiViewer
  abiUrl="/abis/IntegraPaymentV4_5.json"
  contractName="IntegraPayment V4.5"
/>

## Key Features

### Multi-Token Support
Accept payments in ETH and various ERC-20 tokens.

### Fee Management
Automated fee calculation and distribution to platform stakeholders.

### Escrow System
Secure escrow for pending transactions with release mechanisms.

### Payment Verification
On-chain payment verification and receipt generation.

## Main Functions

### processPayment

Process a payment for platform services.

<Tabs items={['TypeScript', 'Python']}>
<Tabs.Tab>
```typescript
import { ethers } from 'ethers';
import IntegraPaymentABI from './abis/IntegraPaymentV4_5.json';

const contract = new ethers.Contract(
  INTEGRA_PAYMENT_ADDRESS,
  IntegraPaymentABI.abi,
  signer
);

// Process ETH payment
const tx = await contract.processPayment(
  serviceId,
  recipient,
  { value: ethers.parseEther('0.1') }
);

await tx.wait();
```
</Tabs.Tab>

<Tabs.Tab>
```python
from web3 import Web3

contract = w3.eth.contract(address=INTEGRA_PAYMENT_ADDRESS, abi=abi)

# Process payment
tx_hash = contract.functions.processPayment(
    service_id,
    recipient
).transact({
    'from': account.address,
    'value': w3.to_wei(0.1, 'ether')
})

receipt = w3.eth.wait_for_transaction_receipt(tx_hash)
```
</Tabs.Tab>
</Tabs>

### getPaymentDetails

Retrieve payment information.

<Tabs items={['TypeScript', 'Python']}>
<Tabs.Tab>
```typescript
const payment = await contract.getPaymentDetails(paymentId);

console.log({
  payer: payment.payer,
  amount: ethers.formatEther(payment.amount),
  timestamp: new Date(payment.timestamp * 1000),
  status: payment.status
});
```
</Tabs.Tab>

<Tabs.Tab>
```python
payment = contract.functions.getPaymentDetails(payment_id).call()

print({
    'payer': payment[0],
    'amount': w3.from_wei(payment[1], 'ether'),
    'timestamp': payment[2],
    'status': payment[3]
})
```
</Tabs.Tab>
</Tabs>

## Events

### PaymentProcessed
```solidity
event PaymentProcessed(
    uint256 indexed paymentId,
    address indexed payer,
    address indexed recipient,
    uint256 amount
);
```

### FeeDistributed
```solidity
event FeeDistributed(
    uint256 indexed paymentId,
    address indexed recipient,
    uint256 amount
);
```

## Related Contracts

- [IntegraLedger V4.5](./integra-ledger) - Core ledger
- [IntegraSignal V4.5](./integra-signal) - Event signaling

## Support

Need help with IntegraPayment?
- ðŸ“§ Email: developers@integraledger.com
- ðŸ’¬ Discord: [Join our community](https://discord.gg/integra)
