import { Tabs } from 'nextra/components'

# API Reference

Welcome to the Integra Trust Platform API Reference. This documentation covers all public-facing APIs available to developers building on Integra.

## Available APIs

Integra provides three main API categories for different use cases:

### üîó Blockchain API
Query blockchain data, transactions, blocks, and document registry information.
- **Base URL:** `https://api.blockchain.trustwithintegra.com`
- **Use Cases:** Block explorers, transaction tracking, document verification
- **[View Documentation ‚Üí](./api-reference/blockchain-api)**

### üë§ Admin & Developer API
Manage authentication, users, organizations, and API keys.
- **Base URL:** `https://api.trustwithintegra.com`
- **Use Cases:** User management, authentication flows, subscription handling
- **[View Documentation ‚Üí](./api-reference/admin-api)**

### ‚ö° RPC API
Direct JSON-RPC access to supported blockchain networks.
- **Base URL:** `https://rpc.trustwithintegra.com`
- **Use Cases:** Direct blockchain interaction, smart contract calls
- **[View Documentation ‚Üí](./api-reference/rpc-api)**

## Quick Start

### 1. Get Your API Key

Sign up for a developer account at [trustwithintegra.com/developers](https://trustwithintegra.com/developers) to receive your API key.

### 2. Make Your First Request

<Tabs items={['cURL', 'TypeScript', 'Python']}>
<Tabs.Tab>
```bash
# Check API status
curl https://api.blockchain.trustwithintegra.com/health \
  -H "Authorization: Bearer YOUR_API_KEY"

# Get chain information
curl https://api.blockchain.trustwithintegra.com/v1/chains \
  -H "Authorization: Bearer YOUR_API_KEY"
```
</Tabs.Tab>

<Tabs.Tab>
```typescript
// Using fetch
const API_KEY = 'your-api-key-here';
const BASE_URL = 'https://api.blockchain.trustwithintegra.com';

async function getChains() {
  const response = await fetch(`${BASE_URL}/v1/chains`, {
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'Content-Type': 'application/json'
    }
  });

  return await response.json();
}

getChains().then(console.log);
```
</Tabs.Tab>

<Tabs.Tab>
```python
import requests

API_KEY = 'your-api-key-here'
BASE_URL = 'https://api.blockchain.trustwithintegra.com'

def get_chains():
    response = requests.get(
        f'{BASE_URL}/v1/chains',
        headers={
            'Authorization': f'Bearer {API_KEY}',
            'Content-Type': 'application/json'
        }
    )
    return response.json()

print(get_chains())
```
</Tabs.Tab>
</Tabs>

### 3. Explore Interactive Documentation

Each API section includes:
- ‚úÖ **Interactive playground** - Test endpoints directly in your browser
- ‚úÖ **Request/response examples** - See real data formats
- ‚úÖ **Code generation** - Generate code in multiple languages
- ‚úÖ **Schema validation** - Understand data structures

## Authentication

All API requests require authentication using a Bearer token.

### JWT Bearer Token

Include your API key in the `Authorization` header:

```bash
Authorization: Bearer YOUR_API_KEY
```

### Obtaining an API Key

1. **Sign up** at [trustwithintegra.com/developers](https://trustwithintegra.com/developers)
2. **Create a project** in the Developer Dashboard
3. **Generate API key** for your project
4. **Copy and secure** your API key (shown only once)

### API Key Security

<div className="nx-mt-6 nx-mb-4 nx-rounded-lg nx-border nx-border-yellow-100 nx-bg-yellow-50 nx-px-4 nx-py-2 dark:nx-border-yellow-200/30 dark:nx-bg-yellow-700/30">
  ‚ö†Ô∏è **Important:** Never expose your API key in client-side code or public repositories. Use environment variables and server-side proxies.
</div>

### Rate Limits

| Plan | Requests/min | Requests/day |
|------|--------------|--------------|
| Free | 60 | 10,000 |
| Starter | 600 | 100,000 |
| Professional | 6,000 | 1,000,000 |
| Enterprise | Custom | Custom |

Rate limit headers are included in all responses:
```
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 45
X-RateLimit-Reset: 1640000000
```

## Response Format

All API responses follow a consistent format:

### Success Response

```json
{
  "success": true,
  "data": {
    // Response data here
  },
  "meta": {
    "timestamp": "2024-01-15T10:30:00Z",
    "requestId": "req_abc123"
  }
}
```

### Error Response

```json
{
  "success": false,
  "error": {
    "code": "INVALID_REQUEST",
    "message": "Missing required parameter: address",
    "details": {
      "field": "address",
      "type": "required"
    }
  },
  "meta": {
    "timestamp": "2024-01-15T10:30:00Z",
    "requestId": "req_abc123"
  }
}
```

### HTTP Status Codes

| Code | Meaning |
|------|---------|
| 200 | Success |
| 201 | Created |
| 400 | Bad Request - Invalid parameters |
| 401 | Unauthorized - Invalid or missing API key |
| 403 | Forbidden - Insufficient permissions |
| 404 | Not Found - Resource doesn't exist |
| 429 | Too Many Requests - Rate limit exceeded |
| 500 | Internal Server Error |
| 503 | Service Unavailable |

## Pagination

List endpoints support cursor-based pagination:

<Tabs items={['cURL', 'TypeScript', 'Python']}>
<Tabs.Tab>
```bash
# First page
curl "https://api.blockchain.trustwithintegra.com/v1/transactions?limit=50" \
  -H "Authorization: Bearer YOUR_API_KEY"

# Next page (use cursor from previous response)
curl "https://api.blockchain.trustwithintegra.com/v1/transactions?limit=50&cursor=abc123" \
  -H "Authorization: Bearer YOUR_API_KEY"
```
</Tabs.Tab>

<Tabs.Tab>
```typescript
async function getTransactions(cursor?: string) {
  const url = new URL(`${BASE_URL}/v1/transactions`);
  url.searchParams.set('limit', '50');
  if (cursor) url.searchParams.set('cursor', cursor);

  const response = await fetch(url, {
    headers: {
      'Authorization': `Bearer ${API_KEY}`
    }
  });

  const data = await response.json();

  // Get next page if available
  if (data.meta.nextCursor) {
    const nextPage = await getTransactions(data.meta.nextCursor);
    return [...data.data, ...nextPage];
  }

  return data.data;
}
```
</Tabs.Tab>

<Tabs.Tab>
```python
def get_transactions(cursor=None):
    params = {'limit': 50}
    if cursor:
        params['cursor'] = cursor

    response = requests.get(
        f'{BASE_URL}/v1/transactions',
        headers={'Authorization': f'Bearer {API_KEY}'},
        params=params
    )

    data = response.json()

    # Get next page if available
    if data['meta'].get('nextCursor'):
        next_page = get_transactions(data['meta']['nextCursor'])
        return data['data'] + next_page

    return data['data']
```
</Tabs.Tab>
</Tabs>

Pagination response includes:

```json
{
  "data": [...],
  "meta": {
    "limit": 50,
    "hasMore": true,
    "nextCursor": "abc123",
    "total": 1543
  }
}
```

## Webhooks

Subscribe to events via webhooks for real-time notifications.

### Available Events

- `transaction.confirmed` - Transaction confirmed on blockchain
- `transaction.failed` - Transaction failed
- `document.registered` - New document registered
- `attestation.created` - New attestation created
- `attestation.revoked` - Attestation revoked

### Webhook Configuration

Configure webhooks in the Developer Dashboard or via API:

```bash
curl -X POST https://api.trustwithintegra.com/v1/webhooks \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://your-app.com/webhooks/integra",
    "events": ["transaction.confirmed", "document.registered"],
    "secret": "your-webhook-secret"
  }'
```

### Webhook Payload

```json
{
  "event": "transaction.confirmed",
  "data": {
    "transactionHash": "0xabc123...",
    "blockNumber": 12345678,
    "status": "confirmed",
    "timestamp": "2024-01-15T10:30:00Z"
  },
  "meta": {
    "webhookId": "wh_abc123",
    "deliveryId": "del_xyz789",
    "timestamp": "2024-01-15T10:30:01Z"
  }
}
```

### Webhook Verification

Verify webhook signatures to ensure authenticity:

<Tabs items={['TypeScript', 'Python']}>
<Tabs.Tab>
```typescript
import crypto from 'crypto';

function verifyWebhook(
  payload: string,
  signature: string,
  secret: string
): boolean {
  const hmac = crypto.createHmac('sha256', secret);
  const digest = hmac.update(payload).digest('hex');
  return crypto.timingSafeEqual(
    Buffer.from(signature),
    Buffer.from(digest)
  );
}

// In your webhook handler
app.post('/webhooks/integra', (req, res) => {
  const signature = req.headers['x-integra-signature'];
  const isValid = verifyWebhook(
    JSON.stringify(req.body),
    signature,
    process.env.WEBHOOK_SECRET
  );

  if (!isValid) {
    return res.status(401).send('Invalid signature');
  }

  // Process webhook
  res.sendStatus(200);
});
```
</Tabs.Tab>

<Tabs.Tab>
```python
import hmac
import hashlib

def verify_webhook(payload: str, signature: str, secret: str) -> bool:
    digest = hmac.new(
        secret.encode(),
        payload.encode(),
        hashlib.sha256
    ).hexdigest()
    return hmac.compare_digest(signature, digest)

# In your webhook handler
@app.route('/webhooks/integra', methods=['POST'])
def webhook_handler():
    signature = request.headers.get('X-Integra-Signature')
    payload = request.get_data(as_text=True)

    if not verify_webhook(payload, signature, os.environ['WEBHOOK_SECRET']):
        return 'Invalid signature', 401

    # Process webhook
    return '', 200
```
</Tabs.Tab>
</Tabs>

## SDKs & Libraries

Official SDKs for popular languages:

### TypeScript/JavaScript
```bash
npm install @integraledger/sdk
```

### Python
```bash
pip install integra-sdk
```

### Go
```bash
go get github.com/integraledger/integra-go
```

## Support & Resources

- üìö **[Smart Contract Guides](../smart-contracts)** - Interact with smart contracts
- üí¨ **[Discord Community](https://discord.gg/integra)** - Get help from the community
- üìß **Email Support** - developers@integraledger.com
- üêõ **Report Issues** - [GitHub Issues](https://github.com/IntegraLedger/integra-sdk/issues)

## API Status

Monitor API status and uptime at [status.trustwithintegra.com](https://status.trustwithintegra.com)

---

Ready to get started? Choose an API to explore:

<div className="nx-mt-6 nx-grid nx-grid-cols-1 nx-gap-4 sm:nx-grid-cols-3">
  <a href="./api-reference/blockchain-api" className="nx-block nx-rounded-lg nx-border nx-border-gray-200 nx-p-4 hover:nx-border-blue-500 hover:nx-shadow-md dark:nx-border-gray-800">
    <h3 className="nx-font-semibold nx-text-lg">Blockchain API ‚Üí</h3>
    <p className="nx-text-sm nx-text-gray-600 dark:nx-text-gray-400">Query blockchain data and documents</p>
  </a>

  <a href="./api-reference/admin-api" className="nx-block nx-rounded-lg nx-border nx-border-gray-200 nx-p-4 hover:nx-border-blue-500 hover:nx-shadow-md dark:nx-border-gray-800">
    <h3 className="nx-font-semibold nx-text-lg">Admin API ‚Üí</h3>
    <p className="nx-text-sm nx-text-gray-600 dark:nx-text-gray-400">Manage users and authentication</p>
  </a>

  <a href="./api-reference/rpc-api" className="nx-block nx-rounded-lg nx-border nx-border-gray-200 nx-p-4 hover:nx-border-blue-500 hover:nx-shadow-md dark:nx-border-gray-800">
    <h3 className="nx-font-semibold nx-text-lg">RPC API ‚Üí</h3>
    <p className="nx-text-sm nx-text-gray-600 dark:nx-text-gray-400">Direct blockchain RPC access</p>
  </a>
</div>
